<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Mini JS Text Learner</title>
<style>
  body {
    font-family: system-ui, sans-serif;
    max-width: 700px;
    margin: 40px auto;
    padding: 20px;
    background: #f5f5f5;
    color: #222;
  }
  h1 { text-align: center; }
  input[type=file], button, textarea {
    width: 100%;
    margin-top: 12px;
    padding: 10px;
    font-size: 16px;
  }
  pre {
    background: white;
    padding: 12px;
    border-radius: 8px;
    height: 200px;
    overflow: auto;
  }
</style>
</head>
<body>

<h1>ðŸ§  Mini JS Text Learner</h1>

<input type="file" id="fileInput" accept=".txt" multiple>
<button id="clearBtn">Clear Memory</button>

<h3>Ask a word:</h3>
<input type="text" id="queryInput" placeholder="Type a word, e.g., love">
<button id="queryBtn">Search associations</button>

<h3>Output:</h3>
<pre id="output"></pre>

<script>
const output = document.getElementById("output");
let memory = JSON.parse(localStorage.getItem("wordMemory") || "{}");

// Tokenizer (simple)
function tokenize(text) {
  return text
    .toLowerCase()
    .replace(/[^a-zA-Z\s]/g, " ")
    .split(/\s+/)
    .filter(Boolean);
}

// Learn from uploaded text
function learnFromText(text) {
  const words = tokenize(text);
  for (let i = 0; i < words.length - 1; i++) {
    const w1 = words[i];
    const w2 = words[i + 1];
    if (!memory[w1]) memory[w1] = {};
    memory[w1][w2] = (memory[w1][w2] || 0) + 1;
  }
  localStorage.setItem("wordMemory", JSON.stringify(memory));
}

// Handle file upload
document.getElementById("fileInput").addEventListener("change", (e) => {
  const files = e.target.files;
  Array.from(files).forEach(file => {
    const reader = new FileReader();
    reader.onload = event => {
      learnFromText(event.target.result);
      output.textContent = `Learned from "${file.name}" (${Object.keys(memory).length} unique words total)`;
    };
    reader.readAsText(file);
  });
});

// Clear memory
document.getElementById("clearBtn").addEventListener("click", () => {
  localStorage.removeItem("wordMemory");
  memory = {};
  output.textContent = "Memory cleared.";
});

// Query associations
document.getElementById("queryBtn").addEventListener("click", () => {
  const word = document.getElementById("queryInput").value.toLowerCase();
  if (!memory[word]) {
    output.textContent = `No data on "${word}".`;
    return;
  }
  const sorted = Object.entries(memory[word])
    .sort((a,b) => b[1]-a[1])
    .slice(0,10)
    .map(([w,c]) => `${w} (${c})`)
    .join(", ");
  output.textContent = `Most common next words after "${word}":\n${sorted}`;
});
</script>
</body>
</html>
