<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Paper Bet Football</title>
    <style>
        /* --- 1. Root & Body (Gamer Minimalist Theme) --- */
        :root {
            --color-bg: #121212;
            --color-bg-light: #1e1e1e;
            --color-bg-lighter: #2a2a2a;
            --color-text: #e0e0e0;
            --color-text-dim: #888;
            --color-accent: #00f0a0; /* Neon Mint */
            --color-accent-dark: #00b377;
            --color-danger: #ff4141;
            --color-warning: #f0e000;
            --font-main: 'Arial', 'Helvetica', sans-serif;
            --font-mono: 'Consolas', 'Courier New', monospace;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: var(--font-main);
            background-color: var(--color-bg);
            color: var(--color-text);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }

        /* --- 2. Main App Container --- */
        #app-container {
            width: 100%;
            max-width: 800px;
            background-color: var(--color-bg-light);
            border-radius: 12px;
            border: 1px solid var(--color-bg-lighter);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        /* --- 3. Header --- */
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 25px;
            background-color: var(--color-bg-lighter);
            border-bottom: 1px solid var(--color-bg);
        }

        header h1 {
            font-size: 1.5rem;
            color: var(--color-text);
            font-weight: 600;
        }

        header h1 span {
            color: var(--color-accent);
            font-weight: 700;
        }

        #balance-display {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--color-accent);
            background-color: var(--color-bg);
            padding: 8px 12px;
            border-radius: 8px;
            font-family: var(--font-mono);
        }

        /* --- 4. Main Content Area --- */
        main {
            padding: 25px;
        }

        .hidden {
            display: none !important;
        }

        /* --- 5. Betting UI --- */
        #betting-ui h2 {
            font-size: 1.2rem;
            color: var(--color-text-dim);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 20px;
            text-align: center;
        }

        .matchup-container {
            display: grid;
            grid-template-columns: 1fr 0.5fr 1fr;
            align-items: center;
            text-align: center;
            margin-bottom: 25px;
        }

        .team {
            padding: 20px;
            background-color: var(--color-bg-lighter);
            border-radius: 8px;
        }

        .team-icon {
            font-size: 3rem;
            line-height: 1;
        }

        .team-name {
            font-size: 1.25rem;
            font-weight: 700;
            margin-top: 10px;
        }

        .vs {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--color-text-dim);
        }

        .odds-container {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 15px;
            margin-bottom: 25px;
        }

        .odd-option {
            background-color: var(--color-bg-lighter);
            border: 2px solid var(--color-bg-lighter);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .odd-option:hover {
            border-color: var(--color-accent);
        }

        .odd-option.selected {
            background-color: var(--color-accent);
            border-color: var(--color-accent);
            color: var(--color-bg);
        }

        .odd-option .label {
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 5px;
            color: var(--color-text-dim);
        }
        
        .odd-option.selected .label {
            color: var(--color-bg);
        }

        .odd-option .value {
            font-size: 1.2rem;
            font-weight: 700;
            font-family: var(--font-mono);
        }

        .bet-input-container {
            display: flex;
            gap: 15px;
        }

        input[type="number"] {
            flex-grow: 1;
            font-family: var(--font-mono);
            font-size: 1.1rem;
            padding: 12px;
            background-color: var(--color-bg);
            border: 2px solid var(--color-bg-lighter);
            color: var(--color-text);
            border-radius: 8px;
            outline: none;
            transition: border-color 0.2s ease;
        }

        input[type="number"]:focus {
            border-color: var(--color-accent);
        }
        
        /* Removing spinners from number input */
        input::-webkit-outer-spin-button,
        input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        input[type=number] {
            -moz-appearance: textfield;
        }

        .btn {
            font-family: var(--font-main);
            font-size: 1.1rem;
            font-weight: 700;
            background-color: var(--color-accent);
            color: var(--color-bg);
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }

        .btn:hover {
            background-color: var(--color-accent-dark);
        }

        .btn:disabled {
            background-color: var(--color-text-dim);
            cursor: not-allowed;
        }

        /* --- 6. Game Simulation UI --- */
        #game-ui {
            font-family: var(--font-mono);
        }

        .scoreboard {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            align-items: center;
            background-color: var(--color-bg-lighter);
            padding: 15px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            text-align: center;
        }

        .score-team {
            font-size: 1.1rem;
            font-weight: 700;
        }
        
        .score-team.home { text-align: left; }
        .score-team.away { text-align: right; }

        .score-display {
            font-size: 2rem;
            font-weight: 700;
            padding: 0 20px;
        }

        .game-timer {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--color-accent);
        }

        #live-feed {
            height: 300px;
            background-color: var(--color-bg);
            border: 1px solid var(--color-bg-lighter);
            border-radius: 8px;
            padding: 15px;
            overflow-y: auto;
            display: flex;
            flex-direction: column-reverse; /* Newest events at the bottom, but auto-scrolls */
        }
        
        .event {
            padding: 8px 10px;
            margin-bottom: 5px;
            border-radius: 4px;
            display: flex;
            align-items: center;
        }
        
        .event .time {
            font-weight: 700;
            color: var(--color-text-dim);
            margin-right: 10px;
            flex-shrink: 0;
        }
        
        .event .text {
            word-break: break-word;
        }

        .event.commentary {
            color: var(--color-text-dim);
        }

        .event.goal {
            background-color: rgba(0, 240, 160, 0.1);
            color: var(--color-accent);
            font-weight: 700;
        }
        
        .event.goal .text::before {
            content: 'âš½ GOAL! ';
        }

        .event.card-yellow {
            background-color: rgba(240, 224, 0, 0.1);
            color: var(--color-warning);
            font-weight: 700;
        }
        
        .event.card-yellow .text::before {
            content: 'ðŸŸ¨ ';
        }
        
        .event.card-red {
            background-color: rgba(255, 65, 65, 0.1);
            color: var(--color-danger);
            font-weight: 700;
        }
        
        .event.card-red .text::before {
            content: 'ðŸŸ¥ ';
        }
        
        .event.half-time, .event.full-time {
            background-color: var(--color-bg-lighter);
            color: var(--color-accent);
            font-weight: 700;
            justify-content: center;
            font-size: 1.1rem;
        }

        /* --- 7. Post-Game Modal --- */
        #modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        
        #modal {
            background-color: var(--color-bg-light);
            padding: 30px;
            border-radius: 12px;
            text-align: center;
            border: 1px solid var(--color-bg-lighter);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            width: 90%;
            max-width: 400px;
        }
        
        #modal h2 {
            font-size: 2rem;
            margin-bottom: 15px;
        }

        #modal-result-win { color: var(--color-accent); }
        #modal-result-lose { color: var(--color-danger); }
        #modal-result-push { color: var(--color-text-dim); }

        #modal p {
            font-size: 1.1rem;
            margin-bottom: 25px;
            color: var(--color-text);
        }

    </style>
</head>
<body>

    <div id="app-container">
        <header>
            <h1>Paper <span>Bet</span></h1>
            <div id="balance-display">$1000</div>
        </header>

        <main>
            <div id="betting-ui">
                <h2>Upcoming Match</h2>
                
                <div class="matchup-container">
                    <div class="team" id="home-team">
                        <div class="team-icon" id="home-team-icon">ðŸ”´</div>
                        <div class="team-name" id="home-team-name">Home</div>
                    </div>
                    
                    <div class="vs">VS</div>
                    
                    <div class="team" id="away-team">
                        <div class="team-icon" id="away-team-icon">ðŸ”µ</div>
                        <div class="team-name" id="away-team-name">Away</div>
                    </div>
                </div>

                <div class="odds-container" id="odds-container">
                    <div class="odd-option" data-bet="home">
                        <div class="label" id="home-bet-label">Home Win</div>
                        <div class="value" id="home-odds">1.85</div>
                    </div>
                    <div class="odd-option" data-bet="draw">
                        <div class="label">Draw</div>
                        <div class="value" id="draw-odds">3.50</div>
                    </div>
                    <div class="odd-option" data-bet="away">
                        <div class="label" id="away-bet-label">Away Win</div>
                        <div class="value" id="away-odds">4.20</div>
                    </div>
                </div>

                <div class="bet-input-container">
                    <input type="number" id="bet-amount" placeholder="Enter bet amount..." min="1">
                    <button class="btn" id="place-bet-btn">Place Bet</button>
                </div>
            </div>

            <div id="game-ui" class="hidden">
                <div class="scoreboard">
                    <div class="score-team home" id="game-home-name">HOME</div>
                    <div class="score-display">
                        <span id="game-home-score">0</span>
                        -
                        <span id="game-away-score">0</span>
                    </div>
                    <div class="score-team away" id="game-away-name">AWAY</div>
                </div>
                
                <div class="game-timer" id="game-timer">00:00</div>
                
                <div id="live-feed">
                    </div>
            </div>

        </main>
    </div>

    <div id="modal-overlay" class="hidden">
        <div id="modal">
            <h2 id="modal-result-text">You Won!</h2>
            <p id="modal-details">Your bet on Manchester Reds won. You earned $185!</p>
            <button class="btn" id="next-match-btn">Next Match</button>
        </div>
    </div>


    <script>
        /* --- 1. DATABASE (Clubs, Players) --- */
        const DB = {
            clubs: [
                {
                    id: 'MAN_RED',
                    name: 'Manchester Reds',
                    icon: 'ðŸ”´',
                    strength: 88, // Overall team strength (affects odds & simulation)
                    players: [
                        { name: 'Marcus Rashford', position: 'FW', rating: 85 },
                        { name: 'Bruno Fernandes', position: 'MF', rating: 88 },
                        { name: 'Lisandro MartÃ­nez', position: 'DF', rating: 86 },
                        { name: 'Casemiro', position: 'MF', rating: 89 },
                        { name: 'AndrÃ© Onana', position: 'GK', rating: 85 },
                        { name: 'Rasmus HÃ¸jlund', position: 'FW', rating: 79 },
                    ]
                },
                {
                    id: 'MAD_WHITE',
                    name: 'Madrid Kings',
                    icon: 'âšª',
                    strength: 92,
                    players: [
                        { name: 'VinÃ­cius Jr.', position: 'FW', rating: 90 },
                        { name: 'Jude Bellingham', position: 'MF', rating: 91 },
                        { name: 'Luka ModriÄ‡', position: 'MF', rating: 87 },
                        { name: 'Antonio RÃ¼diger', position: 'DF', rating: 86 },
                        { name: 'Thibaut Courtois', position: 'GK', rating: 90 },
                        { name: 'Rodrygo', position: 'FW', rating: 86 },
                    ]
                },
                {
                    id: 'BAY_MUNICH',
                    name: 'Munich Titans',
                    icon: 'ðŸŸ¥',
                    strength: 90,
                    players: [
                        { name: 'Harry Kane', position: 'FW', rating: 91 },
                        { name: 'Jamal Musiala', position: 'MF', rating: 88 },
                        { name: 'Joshua Kimmich', position: 'MF', rating: 89 },
                        { name: 'Matthijs de Ligt', position: 'DF', rating: 87 },
                        { name: 'Manuel Neuer', position: 'GK', rating: 88 },
                        { name: 'Leroy SanÃ©', position: 'FW', rating: 86 },
                    ]
                },
                {
                    id: 'FC_CATALONIA',
                    name: 'FC Catalonia',
                    icon: 'ðŸ”µ',
                    strength: 87,
                    players: [
                        { name: 'Robert Lewandowski', position: 'FW', rating: 89 },
                        { name: 'Pedri', position: 'MF', rating: 87 },
                        { name: 'Gavi', position: 'MF', rating: 85 },
                        { name: 'Ronald AraÃºjo', position: 'DF', rating: 86 },
                        { name: 'Marc-AndrÃ© ter Stegen', position: 'GK', rating: 89 },
                        { name: 'Lamine Yamal', position: 'FW', rating: 80 },
                    ]
                },
                {
                    id: 'LIV_REDS',
                    name: 'Liverpool Eagles',
                    icon: 'ðŸ¦…',
                    strength: 89,
                    players: [
                        { name: 'Mohamed Salah', position: 'FW', rating: 90 },
                        { name: 'Virgil van Dijk', position: 'DF', rating: 89 },
                        { name: 'Alisson Becker', position: 'GK', rating: 89 },
                        { name: 'Trent Alexander-Arnold', position: 'DF', rating: 87 },
                        { name: 'Dominik Szoboszlai', position: 'MF', rating: 85 },
                        { name: 'Darwin NÃºÃ±ez', position: 'FW', rating: 83 },
                    ]
                },
                {
                    id: 'PARIS_SG',
                    name: 'Paris Strikers',
                    icon: 'ðŸ—¼',
                    strength: 86,
                    players: [
                        { name: 'Kylian MbappÃ©', position: 'FW', rating: 92 },
                        { name: 'Ousmane DembÃ©lÃ©', position: 'FW', rating: 86 },
                        { name: 'Achraf Hakimi', position: 'DF', rating: 85 },
                        { name: 'Marquinhos', position: 'DF', rating: 87 },
                        { name: 'Gianluigi Donnarumma', position: 'GK', rating: 88 },
                        { name: 'Warren ZaÃ¯re-Emery', position: 'MF', rating: 83 },
                    ]
                }
            ]
        };

        /* --- 2. GAME STATE --- */
        let appState = {
            balance: 1000,
            currentGame: null, // { homeTeam, awayTeam, odds: { home, draw, away } }
            currentBet: null, // { amount, outcome ('home', 'away', 'draw'), odds }
            simulation: {
                minute: 0,
                homeScore: 0,
                awayScore: 0,
                gameInterval: null,
                gameSpeedMs: 300 // How fast a "minute" passes. 1000 = 1 second.
            }
        };

        /* --- 3. DOM ELEMENTS --- */
        const DOMElements = {
            balanceDisplay: document.getElementById('balance-display'),
            bettingUI: document.getElementById('betting-ui'),
            gameUI: document.getElementById('game-ui'),
            
            // Betting
            homeTeamIcon: document.getElementById('home-team-icon'),
            homeTeamName: document.getElementById('home-team-name'),
            awayTeamIcon: document.getElementById('away-team-icon'),
            awayTeamName: document.getElementById('away-team-name'),
            homeBetLabel: document.getElementById('home-bet-label'),
            awayBetLabel: document.getElementById('away-bet-label'),
            homeOdds: document.getElementById('home-odds'),
            drawOdds: document.getElementById('draw-odds'),
            awayOdds: document.getElementById('away-odds'),
            oddsContainer: document.getElementById('odds-container'),
            betAmountInput: document.getElementById('bet-amount'),
            placeBetBtn: document.getElementById('place-bet-btn'),

            // Game
            gameHomeName: document.getElementById('game-home-name'),
            gameAwayName: document.getElementById('game-away-name'),
            gameHomeScore: document.getElementById('game-home-score'),
            gameAwayScore: document.getElementById('game-away-score'),
            gameTimer: document.getElementById('game-timer'),
            liveFeed: document.getElementById('live-feed'),

            // Modal
            modalOverlay: document.getElementById('modal-overlay'),
            modalResultText: document.getElementById('modal-result-text'),
            modalDetails: document.getElementById('modal-details'),
            nextMatchBtn: document.getElementById('next-match-btn'),
        };

        /* --- 4. CORE FUNCTIONS --- */

        /**
         * Initializes the application
         */
        function init() {
            updateBalanceUI();
            setupNewMatch();
            addEventListeners();
        }

        /**
         * Sets up all event listeners
         */
        function addEventListeners() {
            // Bet selection
            DOMElements.oddsContainer.addEventListener('click', (e) => {
                const selectedOption = e.target.closest('.odd-option');
                if (!selectedOption) return;

                // Remove 'selected' from all
                DOMElements.oddsContainer.querySelectorAll('.odd-option').forEach(opt => {
                    opt.classList.remove('selected');
                });
                
                // Add 'selected' to clicked
                selectedOption.classList.add('selected');
                
                const betType = selectedOption.dataset.bet;
                appState.currentBet = {
                    ...appState.currentBet,
                    outcome: betType,
                    odds: appState.currentGame.odds[betType]
                };
            });

            // Place bet button
            DOMElements.placeBetBtn.addEventListener('click', handlePlaceBet);
            
            // Next match button (in modal)
            DOMElements.nextMatchBtn.addEventListener('click', resetForNextMatch);
        }

        /**
         * Selects two new random teams and calculates odds
         */
        function setupNewMatch() {
            // Get two different random clubs
            let clubs = [...DB.clubs];
            let homeIndex = Math.floor(Math.random() * clubs.length);
            let homeTeam = clubs.splice(homeIndex, 1)[0];
            
            let awayIndex = Math.floor(Math.random() * clubs.length);
            let awayTeam = clubs.splice(awayIndex, 1)[0];

            const odds = calculateOdds(homeTeam, awayTeam);
            
            appState.currentGame = { homeTeam, awayTeam, odds };
            appState.currentBet = null; // Clear previous bet
            
            // Update Betting UI
            DOMElements.homeTeamIcon.textContent = homeTeam.icon;
            DOMElements.homeTeamName.textContent = homeTeam.name;
            DOMElements.homeBetLabel.textContent = `${homeTeam.name} Win`;
            DOMElements.homeOdds.textContent = odds.home.toFixed(2);
            
            DOMElements.awayTeamIcon.textContent = awayTeam.icon;
            DOMElements.awayTeamName.textContent = awayTeam.name;
            DOMElements.awayBetLabel.textContent = `${awayTeam.name} Win`;
            DOMElements.awayOdds.textContent = odds.away.toFixed(2);
            
            DOMElements.drawOdds.textContent = odds.draw.toFixed(2);
        }

        /**
         * Calculates odds based on team strength
         */
        function calculateOdds(home, away) {
            const strengthDiff = home.strength - away.strength;
            
            // Base probabilities
            let homeProb = 0.45;
            let drawProb = 0.25;
            let awayProb = 0.30;
            
            // Adjust probs based on strength difference (with a home-field advantage)
            const advantage = (strengthDiff / 100) * 0.2 + 0.05; // Home advantage + strength
            
            homeProb += advantage;
            awayProb -= advantage;
            
            // Normalize (ensure probs add to 1)
            const totalProb = homeProb + drawProb + awayProb;
            homeProb /= totalProb;
            drawProb /= totalProb;
            awayProb /= totalProb;

            // Convert probability to decimal odds (with a small "house edge")
            const margin = 0.05; // 5% house edge
            return {
                home: (1 / homeProb) * (1 - margin),
                draw: (1 / drawProb) * (1 - margin),
                away: (1 / awayProb) * (1 - margin),
            };
        }

        /**
         * Validates and processes the user's bet
         */
        function handlePlaceBet() {
            const amount = parseInt(DOMElements.betAmountInput.value, 10);

            // Validation
            if (isNaN(amount) || amount <= 0) {
                alert("Please enter a valid bet amount.");
                return;
            }
            if (amount > appState.balance) {
                alert("You don't have enough money for that bet.");
                return;
            }
            if (!appState.currentBet || !appState.currentBet.outcome) {
                alert("Please select an outcome to bet on (Home, Draw, or Away).");
                return;
            }

            // Lock in the bet
            appState.currentBet.amount = amount;
            appState.balance -= amount;
            updateBalanceUI();

            // Start the game
            startSimulation();
        }

        /**
         * Updates the balance in the UI
         */
        function updateBalanceUI() {
            DOMElements.balanceDisplay.textContent = `$${appState.balance}`;
        }

        /**
         * Switches from Betting UI to Game UI
         */
        function startSimulation() {
            DOMElements.bettingUI.classList.add('hidden');
            DOMElements.gameUI.classList.remove('hidden');

            // Clear old game
            DOMElements.liveFeed.innerHTML = '';
            appState.simulation.minute = 0;
            appState.simulation.homeScore = 0;
            appState.simulation.awayScore = 0;

            // Setup scoreboard
            const { homeTeam, awayTeam } = appState.currentGame;
            DOMElements.gameHomeName.textContent = homeTeam.name;
            DOMElements.gameAwayName.textContent = awayTeam.name;
            updateScoreboardUI();
            
            // Add kick-off event
            addEventToFeed("00:00", "The match has kicked off!", "commentary");
            
            // Start the game loop
            appState.simulation.gameInterval = setInterval(
                gameTick, 
                appState.simulation.gameSpeedMs
            );
        }

        /**
         * A single "minute" of the game simulation
         */
        function gameTick() {
            appState.simulation.minute++;
            DOMElements.gameTimer.textContent = `${String(appState.simulation.minute).padStart(2, '0')}:00`;

            // Check for half-time
            if (appState.simulation.minute === 45) {
                addEventToFeed("45:00", "Half-Time! The players head to the tunnel.", "half-time");
                return;
            }
            
            // Check for full-time
            if (appState.simulation.minute >= 90) {
                endSimulation();
                return;
            }

            // --- Event Generation Engine ---
            const { homeTeam, awayTeam } = appState.currentGame;
            
            // Base chance for an "event" to happen this minute
            let eventChance = Math.random();
            
            // Adjust chance based on team strengths
            const homeMomentum = (homeTeam.strength / 100) * Math.random();
            const awayMomentum = (awayTeam.strength / 100) * Math.random();

            if (eventChance < 0.025) { // 2.5% chance of a Goal
                if (homeMomentum > awayMomentum) {
                    generateGameEvent('goal', homeTeam);
                } else {
                    generateGameEvent('goal', awayTeam);
                }
            } else if (eventChance < 0.05) { // 2.5% chance of a Card
                if (homeMomentum > awayMomentum) { // Home team commits foul
                    generateGameEvent('card', homeTeam);
                } else { // Away team commits foul
                    generateGameEvent('card', awayTeam);
                }
            } else if (eventChance < 0.25) { // 20% chance of commentary
                if (homeMomentum > awayMomentum) {
                    generateGameEvent('commentary', homeTeam);
                } else {
                    generateGameEvent('commentary', awayTeam);
                }
            }
            // Else (75% of the time), nothing noteworthy happens
        }

        /**
         * Stops the game loop and resolves the bet
         */
        function endSimulation() {
            clearInterval(appState.simulation.gameInterval);
            appState.simulation.gameInterval = null;
            
            DOMElements.gameTimer.textContent = "90:00+";
            addEventToFeed("90:00+", "Full Time! The whistle has blown.", "full-time");
            
            // Wait a moment before showing results
            setTimeout(resolveBet, 1500);
        }
        
        /**
         * Generates a random event (goal, card, commentary)
         */
        function generateGameEvent(type, team) {
            const minute = appState.simulation.minute;
            const timeStr = `${String(minute).padStart(2, '0')}:00`;
            
            // Get a random player from the team
            const player = team.players[Math.floor(Math.random() * team.players.length)];
            let text = '';
            
            switch (type) {
                case 'goal':
                    const scorer = player;
                    // Find an assist
                    let assister = team.players[Math.floor(Math.random() * team.players.length)];
                    while (assister.name === scorer.name) {
                         assister = team.players[Math.floor(Math.random() * team.players.length)];
                    }
                    
                    text = `${scorer.name} (${team.name}) scores! A brilliant finish, assisted by ${assister.name}.`;
                    
                    if (team.id === appState.currentGame.homeTeam.id) {
                        appState.simulation.homeScore++;
                    } else {
                        appState.simulation.awayScore++;
                    }
                    updateScoreboardUI();
                    addEventToFeed(timeStr, text, 'goal');
                    break;
                    
                case 'card':
                    const cardType = Math.random() > 0.1 ? 'yellow' : 'red'; // 10% chance of red
                    text = `A bad tackle from ${player.name} (${team.name}). The referee shows a ${cardType} card!`;
                    addEventToFeed(timeStr, text, `card-${cardType}`);
                    break;
                    
                case 'commentary':
                    const commentaryTemplates = [
                        `Great build-up play from ${team.name}.`,
                        `${player.name} takes a shot from distance... just wide!`,
                        `What a save! The keeper denies ${player.name} from close range.`,
                        `${team.name} are controlling possession well here.`,
                        `A dangerous cross into the box by ${team.name}, but it's cleared away.`
                    ];
                    text = commentaryTemplates[Math.floor(Math.random() * commentaryTemplates.length)];
                    addEventToFeed(timeStr, text, 'commentary');
                    break;
            }
        }
        
        /**
         * Adds an event to the live feed UI
         */
        function addEventToFeed(time, text, type) {
            const eventEl = document.createElement('div');
            eventEl.classList.add('event', type);
            
            eventEl.innerHTML = `<span class="time">${time}</span><span class="text">${text}</span>`;
            
            // Add to top and scroll
            DOMElements.liveFeed.prepend(eventEl);
        }
        
        /**
         * Updates the scoreboard UI with current scores
         */
        function updateScoreboardUI() {
            DOMElements.gameHomeScore.textContent = appState.simulation.homeScore;
            DOMElements.gameAwayScore.textContent = appState.simulation.awayScore;
        }

        /**
         * Checks the bet against the result and shows the modal
         */
        function resolveBet() {
            const { homeScore, awayScore } = appState.simulation;
            const { amount, outcome, odds } = appState.currentBet;
            
            let gameResult;
            if (homeScore > awayScore) gameResult = 'home';
            else if (homeScore < awayScore) gameResult = 'away';
            else gameResult = 'draw';
            
            let modalText = '';
            let modalDetailsText = '';
            let winnings = 0;
            
            const modalResult = DOMElements.modalResultText;
            modalResult.classList.remove('modal-result-win', 'modal-result-lose', 'modal-result-push');

            if (gameResult === outcome) {
                // Bet Won
                winnings = Math.floor(amount * odds);
                appState.balance += winnings;
                
                modalResult.textContent = "You Won!";
                modalResult.classList.add('modal-result-win');
                modalDetailsText = `Your bet on ${outcome} won! You've earned $${winnings}.`;
                
            } else {
                // Bet Lost
                modalResult.textContent = "You Lost";
                modalResult.classList.add('modal-result-lose');
                modalDetailsText = `Your $${amount} bet on ${outcome} lost. Better luck next time.`;
            }
            
            DOMElements.modalDetails.textContent = modalDetailsText;
            updateBalanceUI();
            DOMElements.modalOverlay.classList.remove('hidden');
        }

        /**
         * Hides modal, resets UI for a new match
         */
        function resetForNextMatch() {
            DOMElements.modalOverlay.classList.add('hidden');
            DOMElements.gameUI.classList.add('hidden');
            DOMElements.bettingUI.classList.remove('hidden');
            
            // Clear bet selection
            DOMElements.oddsContainer.querySelectorAll('.odd-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            DOMElements.betAmountInput.value = '';
            
            // Setup next match
            setupNewMatch();
        }


        /* --- 5. START THE APP --- */
        document.addEventListener('DOMContentLoaded', init);

    </script>
</body>
</html>
