<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gemini OS</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Fira+Code&display=swap" rel="stylesheet">

    <script src="https://unpkg.com/@phosphor-icons/web"></script>

    <style>
        :root {
            --font-family-ui: 'Inter', sans-serif;
            --font-family-mono: 'Fira Code', monospace;
            --background-image: url('https://images.unsplash.com/photo-1484268015576-26b8b040679b?q=80&w=2874&auto=format&fit=crop');
            --primary-text: #f0f0f0;
            --glass-bg: rgba(25, 25, 25, 0.2);
            --window-bg: rgba(30, 30, 30, 0.6);
            --border-color: rgba(255, 255, 255, 0.15);
            --shadow-color: rgba(0, 0, 0, 0.4);
            --app-hover-bg: rgba(255, 255, 255, 0.1);
            --active-header-bg: rgba(0, 0, 0, 0.3);
            --inactive-header-bg: rgba(0, 0, 0, 0.2);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        html, body { height: 100%; overflow: hidden; }

        body {
            font-family: var(--font-family-ui);
            background: var(--background-image) center/cover no-repeat;
            color: var(--primary-text);
            user-select: none;
        }

        #desktop { height: 100%; width: 100%; position: relative; overflow: hidden; }

        /* --- Top Bar --- */
        #top-bar {
            position: absolute; top: 0; left: 0; width: 100%; height: 36px;
            background: var(--glass-bg); backdrop-filter: blur(25px); -webkit-backdrop-filter: blur(25px);
            border-bottom: 1px solid var(--border-color); display: flex; align-items: center;
            justify-content: space-between; padding: 0 20px; z-index: 10000;
        }
        #top-bar .logo { font-size: 20px; }
        #date-time { display: flex; gap: 15px; font-size: 14px; font-weight: 500; }

        /* --- Dock --- */
        #dock {
            position: absolute; bottom: 10px; left: 50%; transform: translateX(-50%);
            display: flex; gap: 12px; padding: 8px; background: var(--glass-bg);
            backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
            border-radius: 16px; border: 1px solid var(--border-color);
            box-shadow: 0 4px 30px var(--shadow-color); z-index: 9000;
        }

        .dock-item-container { position: relative; }
        .dock-item {
            width: 56px; height: 56px; font-size: 32px; display: grid; place-items: center;
            border-radius: 12px; cursor: pointer; color: white;
            transition: transform 0.2s cubic-bezier(0.25, 1, 0.5, 1), background-color 0.2s ease;
        }
        .dock-item:hover { transform: scale(1.2) translateY(-8px); background-color: var(--app-hover-bg); }
        .tooltip {
            position: absolute; bottom: 120%; left: 50%; transform: translateX(-50%);
            background: rgba(0,0,0,0.8); color: white; padding: 5px 10px; border-radius: 5px;
            font-size: 13px; font-weight: 500; white-space: nowrap; pointer-events: none;
            opacity: 0; transition: opacity 0.2s ease, bottom 0.2s ease;
        }
        .dock-item-container:hover .tooltip { opacity: 1; bottom: 110%; }

        /* --- Windows --- */
        .window {
            position: absolute; width: 700px; height: 450px;
            background: var(--window-bg); backdrop-filter: blur(30px); -webkit-backdrop-filter: blur(30px);
            border-radius: 12px; border: 1px solid var(--border-color);
            box-shadow: 0 10px 40px var(--shadow-color); display: flex; flex-direction: column;
            overflow: hidden; resize: both; animation: openWindow 0.3s ease-out;
        }
        @keyframes openWindow { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }
        
        .window-header {
            height: 36px; display: flex; align-items: center; padding: 0 10px;
            flex-shrink: 0; transition: background-color 0.2s ease;
        }
        .window.active .window-header { background: var(--active-header-bg); }
        .window:not(.active) .window-header { background: var(--inactive-header-bg); }

        .window-header:active { cursor: grabbing; }
        .window-controls { display: flex; gap: 8px; }
        .control-btn { width: 12px; height: 12px; border-radius: 50%; border: none; cursor: pointer; }
        .close { background-color: #ff5f56; }
        .minimize { background-color: #ffbd2e; }
        .maximize { background-color: #27c93f; }
        .window-title { flex-grow: 1; text-align: center; font-weight: 500; font-size: 14px; padding-right: 60px; }
        .window-body { flex-grow: 1; overflow: auto; display: flex; flex-direction: column;}
        
        .window.maximized { top: 36px !important; left: 0 !important; width: 100% !important; height: calc(100% - 36px - 60px) !important; border-radius: 0; resize: none;}

        /* --- App Specific Styles --- */
        /* Browser */
        .app-browser-nav { display: flex; padding: 8px; background: rgba(0,0,0,0.2); gap: 5px; }
        .app-browser-nav input { flex-grow: 1; background: rgba(0,0,0,0.3); border: 1px solid var(--border-color); border-radius: 5px; color: white; padding: 5px 10px; }
        .app-browser-nav button { background: #4a4a4a; border: none; border-radius: 5px; color: white; padding: 5px 10px; cursor: pointer; }
        .app-browser-content { flex-grow: 1; border: none; background: white; }
        /* Notepad */
        .app-notepad-textarea { width: 100%; height: 100%; background: transparent; border: none; color: white; padding: 15px; font-family: var(--font-family-mono); font-size: 14px; resize: none; outline: none; }
        /* Terminal */
        .app-terminal { padding: 10px; background: rgba(0,0,0,0.5); font-family: var(--font-family-mono); font-size: 13px; flex-grow: 1; overflow-y: auto; }
        .app-terminal .line { display: flex; }
        .app-terminal .prompt { color: #8f8; margin-right: 5px; }
        .app-terminal input { flex-grow: 1; background: none; border: none; color: white; outline: none; font-family: var(--font-family-mono); }
        /* File Explorer */
        .app-files { display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: 20px; padding: 20px; }
        .file-item { text-align: center; cursor: pointer; padding: 10px; border-radius: 5px; }
        .file-item:hover { background: var(--app-hover-bg); }
        .file-item i { font-size: 48px; color: #79bced; }
        .file-item .ph-file-text { color: #ccc; }
        /* Spotify */
        .app-spotify { flex-grow: 1; border: none; }
    </style>
</head>
<body>

    <div id="desktop">
        <div id="top-bar">
            <div class="logo"><i class="ph-fill ph-command"></i></div>
            <div id="date-time">
                <div id="date">Oct 7</div>
                <div id="clock">9:13 PM</div>
            </div>
        </div>
    </div>

    <div id="dock">
        <div class="dock-item-container">
            <div class="dock-item" data-app="Browser"><i class="ph-fill ph-globe"></i></div>
            <div class="tooltip">Browser</div>
        </div>
        <div class="dock-item-container">
            <div class="dock-item" data-app="Terminal"><i class="ph-fill ph-terminal-window"></i></div>
            <div class="tooltip">Terminal</div>
        </div>
        <div class="dock-item-container">
            <div class="dock-item" data-app="Notepad"><i class="ph-fill ph-note-pencil"></i></div>
            <div class="tooltip">Notepad</div>
        </div>
        <div class="dock-item-container">
            <div class="dock-item" data-app="Files"><i class="ph-fill ph-folder-simple"></i></div>
            <div class="tooltip">Files</div>
        </div>
         <div class="dock-item-container">
            <div class="dock-item" data-app="Spotify"><i class="ph-fill ph-spotify-logo"></i></div>
            <div class="tooltip">Spotify</div>
        </div>
    </div>

    <script>
        // --- 1. GLOBAL STATE AND UTILS ---
        const desktop = document.getElementById('desktop');
        const dockItems = document.querySelectorAll('.dock-item');
        let highestZIndex = 100;
        let openWindows = {}; // Track open windows by app name

        // --- 2. DATE & TIME ---
        const dateElement = document.getElementById('date');
        const clockElement = document.getElementById('clock');
        function updateDateTime() {
            const now = new Date();
            dateElement.textContent = now.toLocaleDateString([], { weekday: 'short', month: 'short', day: 'numeric' });
            clockElement.textContent = now.toLocaleTimeString([], { hour: 'numeric', minute: '2-digit' });
        }
        updateDateTime();
        setInterval(updateDateTime, 1000);
        
        // --- 3. WINDOWING SYSTEM ---
        function setActiveWindow(windowEl) {
            document.querySelectorAll('.window').forEach(win => win.classList.remove('active'));
            windowEl.classList.add('active');
            windowEl.style.zIndex = ++highestZIndex;
        }

        dockItems.forEach(item => {
            item.addEventListener('click', () => {
                const appName = item.dataset.app;
                if (openWindows[appName]) {
                    setActiveWindow(openWindows[appName]);
                } else {
                    createWindow(appName);
                }
            });
        });

        function createWindow(appName) {
            const newWindow = document.createElement('div');
            newWindow.className = 'window';
            newWindow.dataset.app = appName;

            const appContent = getAppContent(appName);
            newWindow.innerHTML = `
                <div class="window-header">
                    <div class="window-controls">
                        <button class="control-btn close"></button>
                        <button class="control-btn minimize"></button>
                        <button class="control-btn maximize"></button>
                    </div>
                    <div class="window-title">${appContent.title}</div>
                </div>
                <div class="window-body">${appContent.body}</div>
            `;
            
            const initialPos = Object.keys(openWindows).length * 25;
            newWindow.style.top = `${50 + initialPos}px`;
            newWindow.style.left = `${100 + initialPos}px`;

            desktop.appendChild(newWindow);
            openWindows[appName] = newWindow;
            setActiveWindow(newWindow);
            
            // Add functionality
            makeDraggable(newWindow);
            addWindowEventListeners(newWindow, appName);
            if (appContent.postRender) {
                appContent.postRender(newWindow);
            }
        }
        
        function addWindowEventListeners(windowEl, appName) {
            windowEl.querySelector('.close').addEventListener('click', () => {
                delete openWindows[appName];
                windowEl.remove();
            });
            windowEl.querySelector('.maximize').addEventListener('click', () => {
                windowEl.classList.toggle('maximized');
            });
            windowEl.addEventListener('mousedown', () => setActiveWindow(windowEl), true);
        }

        function makeDraggable(element) {
            const header = element.querySelector('.window-header');
            let isDragging = false, offsetX, offsetY;

            header.addEventListener('mousedown', (e) => {
                if (element.classList.contains('maximized')) return;
                isDragging = true;
                offsetX = e.clientX - element.offsetLeft;
                offsetY = e.clientY - element.offsetTop;
            });
            document.addEventListener('mousemove', (e) => {
                if (isDragging) {
                    element.style.left = `${e.clientX - offsetX}px`;
                    element.style.top = `${e.clientY - offsetY}px`;
                }
            });
            document.addEventListener('mouseup', () => { isDragging = false; });
        }
        
        // --- 4. APP CONTENT & LOGIC ---
        function getAppContent(appName) {
            switch(appName) {
                case 'Browser': return {
                    title: 'Browser',
                    body: `
                        <div class="app-browser-nav">
                            <input type="text" value="https://www.google.com/webhp?igu=1" placeholder="Enter URL">
                            <button>Go</button>
                        </div>
                        <iframe class="app-browser-content" src="https://www.google.com/webhp?igu=1" allowfullscreen></iframe>
                    `,
                    postRender: (win) => {
                        const input = win.querySelector('input');
                        const button = win.querySelector('button');
                        const iframe = win.querySelector('iframe');
                        const go = () => {
                            let url = input.value;
                            if (!url.startsWith('http')) {
                                url = 'https://' + url;
                            }
                            iframe.src = url;
                        };
                        button.addEventListener('click', go);
                        input.addEventListener('keydown', (e) => e.key === 'Enter' && go());
                    }
                };
                case 'Notepad': return {
                    title: 'Notepad',
                    body: `<textarea class="app-notepad-textarea" placeholder="Start typing..."></textarea>`
                };
                 case 'Terminal': return {
                    title: 'Terminal',
                    body: `<div class="app-terminal"><div class="line"><span class="prompt">></span><input type="text" autofocus></div></div>`,
                    postRender: (win) => {
                        const terminal = win.querySelector('.app-terminal');
                        const handleCommand = (e) => {
                            if (e.key !== 'Enter' || !e.target.value) return;
                            const inputLine = e.target.parentElement;
                            const input = e.target;
                            const command = input.value.trim().toLowerCase();
                            input.disabled = true;

                            const output = document.createElement('div');
                            output.innerHTML = processCommand(command);
                            terminal.appendChild(output);
                            
                            const newLine = document.createElement('div');
                            newLine.className = 'line';
                            newLine.innerHTML = '<span class="prompt">></span><input type="text">';
                            terminal.appendChild(newLine);
                            newLine.querySelector('input').focus();
                            terminal.scrollTop = terminal.scrollHeight;
                        };
                        terminal.addEventListener('keydown', handleCommand);
                        win.addEventListener('mousedown', () => terminal.querySelector('input:not([disabled])')?.focus(), true);
                    }
                };
                 case 'Files': return {
                    title: 'File Explorer',
                    body: `
                        <div class="app-files">
                            <div class="file-item"> <i class="ph-fill ph-folder"></i> Documents </div>
                            <div class="file-item"> <i class="ph-fill ph-folder"></i> Pictures </div>
                            <div class="file-item"> <i class="ph-fill ph-folder"></i> Music </div>
                            <div class="file-item"> <i class="ph-fill ph-file-text"></i> resume.pdf </div>
                            <div class="file-item"> <i class="ph-fill ph-file-text"></i> notes.txt </div>
                        </div>
                    `
                };
                case 'Spotify': return {
                    title: 'Spotify',
                    body: `<iframe class="app-spotify" src="https://open.spotify.com/embed/playlist/37i9dQZF1DXcBWIGoYBM5M" allow="encrypted-media"></iframe>`
                };
                default: return { title: 'App', body: 'This app is not implemented.' };
            }
        }

        function processCommand(cmd) {
            const parts = cmd.split(' ');
            switch(parts[0]) {
                case 'help': return 'Available commands: help, date, clear, echo [message]';
                case 'date': return new Date().toString();
                case 'echo': return parts.slice(1).join(' ');
                case 'clear': 
                    document.querySelector('.window[data-app="Terminal"] .app-terminal').innerHTML = '';
                    return '';
                default: return `Command not found: ${cmd}`;
            }
        }

    </script>
</body>
</html>
